# Kind configuration for OCM Spoke cluster 1
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
name: ocm-spoke1
networking:
  # Use dual stack for better compatibility
  ipFamily: dual
  # Disable default CNI to install Cilium for better networking
  disableDefaultCNI: true
  # Different subnets to avoid conflicts with hub and other spokes
  podSubnet: "10.20.0.0/16"
  serviceSubnet: "10.21.0.0/16"
  # Expose API server port for OCM communication
  apiServerAddress: "0.0.0.0"
  apiServerPort: 6444
nodes:
  - role: control-plane
    # Mount Docker socket for potential cluster API usage
    extraMounts:
      - hostPath: /Users/lookfar/.docker/run/docker.sock
        containerPath: /var/run/docker.sock
    # Expose additional ports for OCM components
    extraPortMappings:
      - containerPort: 30002
        hostPort: 30002
        protocol: TCP
      - containerPort: 30003
        hostPort: 30003
        protocol: TCP
  - role: worker
    extraMounts:
      - hostPath: /Users/lookfar/.docker/run/docker.sock
        containerPath: /var/run/docker.sock
